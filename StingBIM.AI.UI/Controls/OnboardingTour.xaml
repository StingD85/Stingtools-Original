<UserControl x:Class="StingBIM.AI.UI.Controls.OnboardingTour"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             x:Name="Root">

    <UserControl.Resources>
        <!-- Tooltip Arrow Style -->
        <Style x:Key="TooltipArrowStyle" TargetType="Path">
            <Setter Property="Fill" Value="{DynamicResource SurfaceBrush}"/>
            <Setter Property="Stroke" Value="{DynamicResource AccentBrush}"/>
            <Setter Property="StrokeThickness" Value="2"/>
        </Style>

        <!-- Step Indicator Style -->
        <Style x:Key="StepIndicatorStyle" TargetType="Ellipse">
            <Setter Property="Width" Value="8"/>
            <Setter Property="Height" Value="8"/>
            <Setter Property="Fill" Value="{DynamicResource ForegroundSecondaryBrush}"/>
            <Setter Property="Margin" Value="3,0"/>
        </Style>
    </UserControl.Resources>

    <!-- Overlay Grid -->
    <Grid x:Name="OverlayGrid" Visibility="Collapsed">
        <!-- Semi-transparent background -->
        <Border x:Name="DimmingLayer"
                Background="#80000000"
                MouseDown="DimmingLayer_MouseDown"/>

        <!-- Highlight cutout (positioned dynamically) -->
        <Border x:Name="HighlightBorder"
                BorderBrush="{DynamicResource AccentBrush}"
                BorderThickness="2"
                CornerRadius="4"
                Background="Transparent"
                HorizontalAlignment="Left"
                VerticalAlignment="Top"
                Visibility="Collapsed">
            <Border.Effect>
                <DropShadowEffect BlurRadius="20"
                                  ShadowDepth="0"
                                  Color="#3B82F6"
                                  Opacity="0.8"/>
            </Border.Effect>
        </Border>

        <!-- Tour Tooltip (positioned dynamically) -->
        <Border x:Name="TooltipBorder"
                HorizontalAlignment="Left"
                VerticalAlignment="Top"
                MaxWidth="320"
                Background="{DynamicResource SurfaceBrush}"
                BorderBrush="{DynamicResource AccentBrush}"
                BorderThickness="1"
                CornerRadius="12"
                Padding="20">
            <Border.Effect>
                <DropShadowEffect BlurRadius="20"
                                  ShadowDepth="4"
                                  Direction="270"
                                  Opacity="0.3"/>
            </Border.Effect>

            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- Header with step icon -->
                <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,12">
                    <Border Background="{DynamicResource AccentBrush}"
                            CornerRadius="20"
                            Padding="10,5"
                            Margin="0,0,10,0">
                        <StackPanel Orientation="Horizontal">
                            <Path x:Name="StepIcon"
                                  Fill="White"
                                  Width="14" Height="14"
                                  Stretch="Uniform"
                                  Margin="0,0,6,0"
                                  VerticalAlignment="Center"/>
                            <TextBlock x:Name="StepNumberText"
                                       Text="Step 1 of 5"
                                       FontSize="11"
                                       FontWeight="SemiBold"
                                       Foreground="White"
                                       VerticalAlignment="Center"/>
                        </StackPanel>
                    </Border>

                    <!-- Close button -->
                    <Button x:Name="CloseButton"
                            Click="CloseButton_Click"
                            HorizontalAlignment="Right"
                            Style="{DynamicResource IconButtonStyle}"
                            ToolTip="Skip tour"
                            Margin="auto,0,0,0">
                        <Path Data="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"
                              Fill="{DynamicResource ForegroundSecondaryBrush}"
                              Width="14" Height="14"
                              Stretch="Uniform"/>
                    </Button>
                </StackPanel>

                <!-- Title -->
                <TextBlock Grid.Row="1"
                           x:Name="StepTitleText"
                           Text="Welcome to StingBIM AI"
                           FontSize="16"
                           FontWeight="SemiBold"
                           Foreground="{DynamicResource ForegroundBrush}"
                           TextWrapping="Wrap"
                           Margin="0,0,0,8"/>

                <!-- Description -->
                <TextBlock Grid.Row="2"
                           x:Name="StepDescriptionText"
                           Text="Let's take a quick tour of the interface."
                           FontSize="13"
                           Foreground="{DynamicResource ForegroundSecondaryBrush}"
                           TextWrapping="Wrap"
                           LineHeight="20"
                           Margin="0,0,0,16"/>

                <!-- Navigation -->
                <Grid Grid.Row="3">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <!-- Step indicators -->
                    <StackPanel x:Name="StepIndicators"
                                Grid.Column="0"
                                Orientation="Horizontal"
                                VerticalAlignment="Center"/>

                    <!-- Navigation buttons -->
                    <StackPanel Grid.Column="1"
                                Orientation="Horizontal"
                                HorizontalAlignment="Right">
                        <Button x:Name="PreviousButton"
                                Content="Back"
                                Click="PreviousButton_Click"
                                Style="{DynamicResource SecondaryButtonStyle}"
                                Padding="12,6"
                                Margin="0,0,8,0"
                                Visibility="Collapsed"/>
                        <Button x:Name="NextButton"
                                Content="Next"
                                Click="NextButton_Click"
                                Style="{DynamicResource PrimaryButtonStyle}"
                                Padding="16,6"/>
                    </StackPanel>
                </Grid>
            </Grid>
        </Border>

        <!-- Arrow pointer (positioned dynamically) -->
        <Path x:Name="TooltipArrow"
              Style="{StaticResource TooltipArrowStyle}"
              HorizontalAlignment="Left"
              VerticalAlignment="Top"
              Visibility="Collapsed"/>
    </Grid>
</UserControl>
