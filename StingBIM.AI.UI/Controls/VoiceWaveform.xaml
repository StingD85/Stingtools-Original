<UserControl x:Class="StingBIM.AI.UI.Controls.VoiceWaveform"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             x:Name="Root"
             Width="200"
             Height="60">

    <UserControl.Resources>
        <!-- Bar animation storyboard -->
        <Style x:Key="WaveformBarStyle" TargetType="Rectangle">
            <Setter Property="Fill" Value="{DynamicResource AccentBrush}"/>
            <Setter Property="RadiusX" Value="2"/>
            <Setter Property="RadiusY" Value="2"/>
            <Setter Property="Width" Value="4"/>
            <Setter Property="MinHeight" Value="4"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="HorizontalAlignment" Value="Center"/>
            <Setter Property="RenderTransformOrigin" Value="0.5,0.5"/>
        </Style>

        <!-- Pulse animation for recording indicator -->
        <Storyboard x:Key="PulseAnimation" RepeatBehavior="Forever">
            <DoubleAnimation Storyboard.TargetName="RecordingIndicator"
                           Storyboard.TargetProperty="Opacity"
                           From="1.0" To="0.3" Duration="0:0:0.6"
                           AutoReverse="True"/>
        </Storyboard>

        <!-- Wave animation for idle state -->
        <Storyboard x:Key="IdleWaveAnimation" RepeatBehavior="Forever">
            <DoubleAnimation Storyboard.TargetName="Bar0" Storyboard.TargetProperty="Height"
                           From="8" To="16" Duration="0:0:0.4" AutoReverse="True" BeginTime="0:0:0"/>
            <DoubleAnimation Storyboard.TargetName="Bar1" Storyboard.TargetProperty="Height"
                           From="8" To="20" Duration="0:0:0.4" AutoReverse="True" BeginTime="0:0:0.1"/>
            <DoubleAnimation Storyboard.TargetName="Bar2" Storyboard.TargetProperty="Height"
                           From="8" To="24" Duration="0:0:0.4" AutoReverse="True" BeginTime="0:0:0.2"/>
            <DoubleAnimation Storyboard.TargetName="Bar3" Storyboard.TargetProperty="Height"
                           From="8" To="20" Duration="0:0:0.4" AutoReverse="True" BeginTime="0:0:0.3"/>
            <DoubleAnimation Storyboard.TargetName="Bar4" Storyboard.TargetProperty="Height"
                           From="8" To="16" Duration="0:0:0.4" AutoReverse="True" BeginTime="0:0:0.4"/>
        </Storyboard>
    </UserControl.Resources>

    <Grid Background="Transparent">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto"/>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="Auto"/>
        </Grid.ColumnDefinitions>

        <!-- Recording indicator dot -->
        <Grid Grid.Column="0" VerticalAlignment="Center" Margin="0,0,12,0">
            <Ellipse x:Name="RecordingIndicator"
                     Width="12" Height="12"
                     Fill="{DynamicResource ErrorBrush}"
                     Visibility="Collapsed"/>
            <Ellipse x:Name="IdleIndicator"
                     Width="12" Height="12"
                     Fill="{DynamicResource ForegroundSecondaryBrush}"
                     Opacity="0.5"
                     Visibility="Visible"/>
        </Grid>

        <!-- Waveform visualization -->
        <Border Grid.Column="1"
                Background="{DynamicResource CardBrush}"
                CornerRadius="8"
                Padding="10,8"
                MinWidth="100">

            <!-- Canvas-based waveform for real audio data -->
            <Grid>
                <!-- Static bars for simple visualization -->
                <StackPanel x:Name="SimpleBarsPanel"
                            Orientation="Horizontal"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            Visibility="Visible">
                    <Rectangle x:Name="Bar0" Style="{StaticResource WaveformBarStyle}" Height="8" Margin="2,0"/>
                    <Rectangle x:Name="Bar1" Style="{StaticResource WaveformBarStyle}" Height="8" Margin="2,0"/>
                    <Rectangle x:Name="Bar2" Style="{StaticResource WaveformBarStyle}" Height="8" Margin="2,0"/>
                    <Rectangle x:Name="Bar3" Style="{StaticResource WaveformBarStyle}" Height="8" Margin="2,0"/>
                    <Rectangle x:Name="Bar4" Style="{StaticResource WaveformBarStyle}" Height="8" Margin="2,0"/>
                    <Rectangle x:Name="Bar5" Style="{StaticResource WaveformBarStyle}" Height="8" Margin="2,0"/>
                    <Rectangle x:Name="Bar6" Style="{StaticResource WaveformBarStyle}" Height="8" Margin="2,0"/>
                    <Rectangle x:Name="Bar7" Style="{StaticResource WaveformBarStyle}" Height="8" Margin="2,0"/>
                    <Rectangle x:Name="Bar8" Style="{StaticResource WaveformBarStyle}" Height="8" Margin="2,0"/>
                    <Rectangle x:Name="Bar9" Style="{StaticResource WaveformBarStyle}" Height="8" Margin="2,0"/>
                    <Rectangle x:Name="Bar10" Style="{StaticResource WaveformBarStyle}" Height="8" Margin="2,0"/>
                    <Rectangle x:Name="Bar11" Style="{StaticResource WaveformBarStyle}" Height="8" Margin="2,0"/>
                    <Rectangle x:Name="Bar12" Style="{StaticResource WaveformBarStyle}" Height="8" Margin="2,0"/>
                    <Rectangle x:Name="Bar13" Style="{StaticResource WaveformBarStyle}" Height="8" Margin="2,0"/>
                    <Rectangle x:Name="Bar14" Style="{StaticResource WaveformBarStyle}" Height="8" Margin="2,0"/>
                </StackPanel>

                <!-- Canvas for detailed waveform (advanced mode) -->
                <Canvas x:Name="WaveformCanvas"
                        ClipToBounds="True"
                        Visibility="Collapsed"/>

                <!-- Idle text -->
                <TextBlock x:Name="IdleText"
                           Text="Click to start voice input"
                           FontSize="11"
                           Foreground="{DynamicResource ForegroundSecondaryBrush}"
                           HorizontalAlignment="Center"
                           VerticalAlignment="Center"
                           Visibility="Collapsed"/>
            </Grid>
        </Border>

        <!-- Duration/status display -->
        <StackPanel Grid.Column="2"
                    VerticalAlignment="Center"
                    Margin="12,0,0,0">
            <TextBlock x:Name="DurationText"
                       Text="0:00"
                       FontSize="14"
                       FontWeight="SemiBold"
                       Foreground="{DynamicResource ForegroundBrush}"
                       HorizontalAlignment="Center"/>
            <TextBlock x:Name="StatusText"
                       Text="Ready"
                       FontSize="10"
                       Foreground="{DynamicResource ForegroundSecondaryBrush}"
                       HorizontalAlignment="Center"/>
        </StackPanel>
    </Grid>
</UserControl>
